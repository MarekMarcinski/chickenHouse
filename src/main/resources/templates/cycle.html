<!DOCTYPE html>
<html lang="pl" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <title th:text="'Rzut z dnia: ' + ${cycle.startDay}"></title>
    <th:block th:include="partials/scripts_css" />
</head>
	
<body>
	<img th:src="@{/images/logo.png}" class="logo_all" alt="LOGO">
	<form th:action="@{/logout}" method="get"><button type="submit" id="button_logout_cycle" class="button_logout">WYLOGUJ</button></form><br><br><br>
	<form th:action="@{'/home/' + ${chickenHouseId}}" method="get"><button type="submit" id="button_back_house" class="button_back">WRÓĆ</button></form><br><br><br><br><br><br>
	<table align="center" style="width:72%" id="table_cycle">
		<tr align="center">
			<td align="center" class="table_cycle_right"><p th:text="'Dzień wstawienia: ' + ${cycle.getStartDay()}"></p></td>
			<td align="center" class="table_cycle_right"><p>Lista dostaw paszy z datami:</p></td>
			<td align="center" class="table_cycle_right"><p>Lista lekarstw z datami:</p></td>
			<td align="center" class="table_cycle_right"></td>
		</tr>
		<tr>
			<td class="table_cycle_right"><p th:text="'Hybryd: ' + ${cycle.getHybrid()}"></p></td>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"></td>
			<td align="center"><div class="col-md-6 dropdown" th:if="${!cycle.isCompleted()}">
            <a class="btn btn-secondary dropdown-toggle col-md-12 edit_cycle" role="button" id="editDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Edycja</a>
            <form class="dropdown-menu p-2" autocomplete="off" about="#" th:action="@{'/home/cycle/' + ${cycle.getId()}}" th:object="${cycle}" th:method="put">
                <div class="form-group"><label>Data wstawienia<input type="date" th:field="*{startDay}" class="form-control" id="startDay"></label></div>
                <div class="form-group"><label>Liczba wstawionych kurczaków<input type="number" th:field="*{numberOfChickens}" class="form-control" id="numberOfChickens"></label></div>
                <div class="form-group"><label>Wylęgarnia<input type="text"  th:field="*{hatchery}" class="form-control" id="hatchery"></label></div>
                <div class="form-group"><label>Hybryd<input type="text"  th:field="*{hybrid}" class="form-control" id="hybrid"></label></div>
				<button type="submit" class="btn btn-primary newDropdown_house">Edytuj</button>
            </form></div></td>
		</tr>
		<tr>
			<td class="table_cycle_right"><p th:text="'Wylęgarnia: ' + ${cycle.getHatchery()}"></p></td>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"></td>
		</tr>
		<tr>
			<td class="table_cycle_right"><p th:text="'Początkowa liczba stada: ' + ${cycle.getNumberOfChickens()}"></p></td>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"></td>
			<td align="center"><div class="col-md-6 dropdown" th:if="${!cycle.isCompleted()}"><a class="btn btn-secondary dropdown-toggle col-md-12 edit_cycle" role="button" id="delete_dropdown_cycle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Zakończ</a>
            <form class="dropdown-menu p-4" autocomplete="off" th:action="@{'/home/cycle/complete/' + ${cycle.getId()}}" th:object="${cycle}" th:method="put">
				<label>Potwierdź zakończenie</label><button type="submit" class="btn btn-primary newDropdown_house">Zakończ</button>
            </form></div></td>
		</tr>
		<tr>
			<td class="table_cycle_right"><p th:text="'Aktualna liczba stada: ' + ${actualNumberOfChicken}"></p></td>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"></td>
		</tr>
		<tr>
			<td class="table_cycle_right"></td>
			<td class="table_cycle_right"><div>
				<ul type="circle" th:each="forage : ${forages}">
					<form th:action="@{'/home/cycle/day/forage/' + ${forage.getId()}}" th:method="delete"><button id="pasza_delete_cycle" type="submit">X</button></form>
					<li th:text="${forage.getDeliveryDate()}"></li>
					<ul type="square">
						<li th:text="${forage.getName()}"></li>
						<li th:text="${forage.getQuantity() + ' kg'}"></li>
					</ul></ul>
            </div></td>
			<td class="table_cycle_right"><div>
				<!--<ul type="circle" th:each="medicines : ${medicinesList}">-->
                    <!--<li>Lista z dnia: </li>-->
					<!--<ul th:each="medicineList : ${medicines}">-->
                        <!--<li th:text="${medicineList.getName()}"></li>-->
                    <!--</ul>-->
					<!--</ul>-->
            </div></td>
			<td class="table_cycle_right"></td>
		</tr>
	</table><br><br><br>
<div class="container">
    <div>
        <form autocomplete="off" th:action="@{'/home/cycle/day/' + ${cycle.getId()}}"
                th:object="${dayDto}" th:method="post" th:if="${!cycle.isCompleted()}">
            <div class="form-row">
                <div class="form-group col-md-2"><label>Dzień tuczu</label><input type="hidden" th:field="*{dayNumber}" th:value="${dayDto.getDayNumber()}">
					<p style="alignment: center" th:text="*{dayNumber}"></p></div>
                <div class="form-group col-md-2"><label>Upadki<input type="number" th:field="*{naturalDowns}" class="form-control" id="naturalDowns" min="0"></label></div>
                <div class="form-group col-md-2"><label>Selekcja<input type="number" th:field="*{selectionDowns}" class="form-control" id="selectionDowns" min="0"></label></div>
                <div class="form-group col-md-2"><label>Stan licznika wody<input type="number" th:field="*{waterCounter}" class="form-control" id="waterCounter" min="0"></label></div>
                <div class="form-group col-md-2"><label>Średnia waga<input type="number" th:field="*{averageWeight}" class="form-control" id="averageWeight" min="0"></label></div>
                <div class="form-group col-md-2"><label>Uwagi<textarea rows="1" id="comments" th:field="*{comments}"></textarea></label></div>
            </div>
            <button type="submit" class="btn btn-primary" id="button_nowy_cycle">ZATWIERDŹ</button>
        </form>
    </div>
	<div><br><br><br>
        <table class="col-md-12 table table-striped">
            <thead><tr>
                <th scope="col">Dzień tuczu</th>
                <th scope="col">Upadki</th>
                <th scope="col">Selekcja</th>
                <th scope="col">Razem</th>
                <th scope="col">Stan licznika wody</th>
                <th scope="col">Dzienne zużycie wody</th>
                <th scope="col">Średnia waga kurczaka (gram)</th>
                <th scope="col">&nbsp;&nbsp;&nbsp;&nbsp;WŚD</th>
                <th scope="col">Uwagi</th>
                <th scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr></thead>
            <tbody><tr align="center" th:each="d,i : ${days}">
                <th align="center" th:text="${d.getDayNumber()}"></th>
                <th align="center" th:text="${d.getNaturalDowns()}"></th>
                <th align="center" th:text="${d.getSelectionDowns()}"></th>
                <th align="center" th:text="${(d.getNaturalDowns() + d.getSelectionDowns())}"></th>
                <th align="center" th:text="${d.getWaterCounter()}"></th>
                <th align="center" th:text="${i.index > 0 && days[(i.index - 1)].getWaterCounter() > days[i.index].getWaterCounter()
                ? days[(i.index - 1)].getWaterCounter() - days[i.index].getWaterCounter() : 0}"></th>
                <th align="center" th:text="${d.getAverageWeight()}"></th>
                <th align="center" th:text="${#numbers.formatDecimal(d.getAllDowns() * 100 / actualNumberOfChicken, 1, 3)}"></th>
                <th align="center" th:text="${d.getComments()}"></th>
                <th>
                    <a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown" role="button" id="forageDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dostawa paszy</a>
                    <form class="dropdown-menu p-2" autocomplete="off" th:action="@{'/home/cycle/day/forage/' + ${d.getId()}}"
                          th:object="${forageDto}" th:method="put">
                        <div class="form-group"><label>Rodzaj paszy<input type="text" th:field="*{name}" class="form-control" id="forageName"></label></div>
                        <div class="form-group"><label>Ilość<input type="number" th:field="*{quantity}" class="form-control" id="quantity"></label></div>
                        <div class="form-group"><label>Cena<input type="number" th:field="*{price}" class="form-control" id="foragePrice"></label></div>
						<button type="submit" class="btn btn-primary newDropdown_house">Dodaj dostawę</button>
                    </form>
                </th>
                <th>
                    <a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown" role="button" id="medicineDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Lekarstwa</a>
                    <form class="dropdown-menu p-2" autocomplete="off" th:action="@{'/home/cycle/day/medicine/' + ${d.getId()}}"
                          th:object="${medicineDto}" th:method="put">
                        <div class="form-group"><label>Nazwa lekarstwa<input type="text" th:field="*{name}" class="form-control" id="name"></label></div>
                        <div class="form-group"><label>Cena<input type="number" th:field="*{price}" class="form-control" id="medicinePrice"></label></div>
						<button type="submit" class="btn btn-primary newDropdown_house">Dodaj lekarstwo</button>
                    </form>
                </th>
                <th>
					<!--TODO jak zrobić wstrzykiwanie do każdej edycji inną wartość-->
                    <a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown" role="button" id="dayDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Edycja dnia</a>
                    <form class="dropdown-menu p-2" autocomplete="off" th:action="@{'/home/cycle/day/' + ${d.getId()}}" th:method="put" th:object="${dayDto}">
                        <div class="form-group"><label>Upadki<input type="number" th:field="*{naturalDowns}" class="form-control" id="editNaturalDowns"></label></div>
                        <div class="form-group"><label>Selekcja<input type="number" th:field="*{selectionDowns}" class="form-control" id="editSelectionDowns"></label></div>
                        <div class="form-group"><label>Stan licznika wody<input type="number" th:field="*{waterCounter}" class="form-control" id="editWaterCounter"></label></div>
                        <div class="form-group"><label>Średnia waga kurczaka<input type="number" th:field="*{averageWeight}" class="form-control" id="editAverageWeight"></label></div>
                        <div class="form-group"><label>Uwagi<input type="text" th:field="*{comments}" class="form-control" id="editComments"></label></div>
						<button type="submit" class="btn btn-primary newDropdown_house">Edytuj</button>
                    </form>
                </th>
            </tr></tbody>
        </table>
    </div>
</div>
</body>
</html>