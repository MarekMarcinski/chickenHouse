<!DOCTYPE html>
<html lang="pl" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <title th:text="'Rzut z dnia: ' + ${cycle.startDay}"></title>
    <th:block th:include="partials/scripts_css" />
</head>
	
<body>
	<img th:src="@{/images/logo.png}" class="logo_all" alt="LOGO">
	<form th:action="@{/logout}" method="get"><button type="submit" id="button_logout_cycle" class="button_logout">WYLOGUJ</button></form><br><br><br>
	<form th:action="@{'/home/' + ${chickenHouseId}}" method="get"><button type="submit" id="button_back_house" class="button_back">WRÓĆ</button></form><br><br><br>
    <form th:action="@{'/home/cycle/slaughter/' + ${cycle.getId()}}" method="get"><button type="submit" id="button_uboj_house" class="button_back">UBÓJ</button></form>
	<div id="srodek_buttony_cycle"><div class="rowek">
		<div class="col-md-6 dropdown" th:if="${!cycle.isCompleted()}">
            <a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown" role="button" id="editDropdownCycle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Edycja</a>
            <form class="dropdown-menu p-2" autocomplete="off" about="#" th:action="@{'/home/cycle/' + ${cycle.getId()}}" th:object="${cycle}" th:method="put">
                <div class="form-group"><label>Data wstawienia<input type="date" th:field="*{startDay}" class="form-control" id="startDay"></label></div>
                <div class="form-group"><label>Liczba wstawionych kurczaków<input type="number" th:field="*{numberOfChickens}" class="form-control" id="numberOfChickens"></label></div>
                <div class="form-group"><label>Wylęgarnia<input type="text"  th:field="*{hatchery}" class="form-control" id="hatchery"></label></div>
                <div class="form-group"><label>Hybryd<input type="text"  th:field="*{hybrid}" class="form-control" id="hybrid"></label></div>
                <div class="form-group"><label>Cena za kg (netto)<input type="number" min="0" step="0.01" th:field="*{price}" class="form-control" id="price"></label></div>
				<button type="submit" class="btn btn-primary newDropdown_house">Edytuj</button></form></div>
		<div class="col-md-6 dropdown" th:if="${!cycle.isCompleted()}">
			<a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown" role="button" id="delete_dropdown_cycle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Zakończ</a>
        <form class="dropdown-menu p-4" autocomplete="off" th:action="@{'/home/cycle/complete/' + ${cycle.getId()}}" th:object="${cycle}" th:method="put">
            <label>Potwierdź zakończenie</label><button type="submit" class="btn btn-primary newDropdown_house">Zakończ</button></form></div></div></div><br>
	<table align="center" class="table_cycle">
		<tr align="center"><td align="center"><p class="p_pogrubienie" th:text="'Dzień wstawienia: ' + ${cycle.getStartDay()}"></p></td></tr>
		<tr align="center"><td align="center"><p th:text="'Hybryd: ' + ${cycle.getHybrid()}"></p></td></tr>
		<tr align="center"><td align="center"><p th:text="'Wylęgarnia: ' + ${cycle.getHatchery()}"></p></td></tr>
		<tr align="center"><td align="center"><p th:text="'Początkowa liczba stada: ' + ${cycle.getNumberOfChickens()}"></p></td></tr>
		<tr align="center"><td align="center"><p th:text="'Aktualna liczba stada: ' + ${actualNumberOfChicken}"></p></td></tr>
	</table>
	<table align="center" class="table_cycle">
		<tr align="center">
			<td width="50%" align="center" class="table_cycle_right"><p class="p_pogrubienie">Lista dostaw paszy z datami:</p></td>
			<td width="50%" align="center" class="table_cycle_right"><p class="p_pogrubienie">Lista lekarstw z datami:</p></td>
		</tr>
		<tr>
			<td align="center" class="table_cycle_right"><div>
				<ul type="circle" class="p_pogrubienie" th:each="forage : ${forages}">
					<form th:action="@{'/home/cycle/day/forage/' + ${forage.getId()}}" th:method="delete"><button id="pasza_delete_cycle" type="submit">X</button></form>
					<li th:text="${forage.getDeliveryDate()}"></li>
					<ul type="square" class="p_normal">
						<li th:text="${forage.getName()}"></li>
						<li th:text="${forage.getQuantity() + ' kg'}"></li>
					</ul></ul>
            </div></td>
			<td align="center" class="table_cycle_right"><div>
				<ul type="circle" class="p_pogrubienie" th:each="medicineList : ${medicineListDtos}">
                    <li th:if="${medicineList.getMedicineDtos().size() > 0}" th:text="${medicineList.getApplicationDate()}"></li>
					<ul type="square" class="p_normal" th:each="medicine : ${medicineList.getMedicineDtos()}">
                        <form th:action="@{'/home/cycle/day/medicine/' + ${medicine.getId()}}" th:method="delete"><button id="leki_delete_cycle" type="submit">X</button></form>
                        <li th:text="${medicine.getName()}"></li>
                    </ul></ul>
            </div></td>
		</tr>
	</table><br><br><br>
	<div class="container">
        <form autocomplete="off" th:action="@{'/home/cycle/day/' + ${cycle.getId()}}"
                th:object="${dayDto}" th:method="post" th:if="${!cycle.isCompleted()}">
            <div class="form-row">
                <div class="form-group col-md-2"><p class="cycle_srodkowanie"><label class="not_strong">Dzień tuczu</label><br><input type="hidden" th:field="*{dayNumber}" th:value="${dayDto.getDayNumber()}"  th:text="*{dayNumber}"></p></div>
                <div class="form-group col-md-2"><p class="cycle_srodkowanie"><label class="not_strong">Upadki<input type="number" th:field="*{naturalDowns}" class="form-control" id="naturalDowns" min="0"></label></p></div>
                <div class="form-group col-md-2"><p class="cycle_srodkowanie"><label class="not_strong">Selekcja<input type="number" th:field="*{selectionDowns}" class="form-control" id="selectionDowns" min="0"></label></p></div>
                <div class="form-group col-md-2"><p class="cycle_srodkowanie"><label class="not_strong">Stan licznika wody<input type="number" th:field="*{waterCounter}" class="form-control" id="waterCounter" min="0"></label></p></div>
                <div class="form-group col-md-2"><p class="cycle_srodkowanie"><label class="not_strong">Średnia waga<input type="number" th:field="*{averageWeight}" class="form-control" id="averageWeight" min="0"></label></p></div>
                <div class="form-group col-md-2"><p class="cycle_srodkowanie"><label class="not_strong">Uwagi</label><br><textarea rows="1" id="comments" th:field="*{comments}"></textarea></p></div>
            <button type="submit" class="btn btn-primary" id="button_nowy_cycle">ZATWIERDŹ</button>
		</div></form>
    </div><br><br><br>
	<div class="lista_rozwijana_srodek" align="center">
		<div th:each="d,i : ${days}" id="sizer_cycle">
            <div id="accordion">
                <div class="card">
                    <div class="card-header"><a class="accordion-toggle black_strong" data-toggle="collapse" data-parent="#accordion" th:href="'#collapseOne' + ${d.getId()}" th:text="'Dzień tuczu: ' + ${d.getDayNumber()}"></a></div>
                    <div th:id="'collapseOne' + ${d.getId()}" class="panel-collapse collapse in"><div class="card-block">
<table class="table_cycle_big">
	<tr class="border_cycle table_cycle_strong color_trzeci_wiersz gray_strong">
		<td class="border_cycle" align="center">Dzień tuczu</td>
        <td class="border_cycle" align="center">Upadki</td>
        <td class="border_cycle" align="center">Selekcja</td>
        <td class="border_cycle" align="center">Razem</td>
	</tr><tr class="black_strong">
        <td class="border_cycle" align="center" th:text="${d.getDayNumber()}"></td>
        <td class="border_cycle" align="center" th:text="${d.getNaturalDowns()}"></td>
        <td class="border_cycle" align="center" th:text="${d.getSelectionDowns()}"></td>
        <td class="border_cycle" align="center" th:text="${(d.getNaturalDowns() + d.getSelectionDowns())}"></td>
	</tr><tr class="border_cycle table_cycle_strong color_trzeci_wiersz gray_strong">
        <td class="border_cycle" align="center">Stan licznika wody</td>
        <td class="border_cycle" align="center">Dzienne zużycie wody</td>
        <td class="border_cycle" align="center">Średnia waga kurczaka(g)</td>
        <td class="border_cycle" align="center">WŚD</td>
	</tr><tr class="black_strong">
        <td class="border_cycle" align="center" th:text="${d.getWaterCounter()}"></td>
        <td class="border_cycle" align="center" th:text="${i.index > 0 && days[(i.index - 1)].getWaterCounter() > days[i.index].getWaterCounter() ? days[(i.index - 1)].getWaterCounter() - days[i.index].getWaterCounter() : 0}"></td>
		<td class="border_cycle" align="center" th:text="${d.getAverageWeight()}"></td>
        <td class="border_cycle" align="center" th:text="${#numbers.formatDecimal(d.getAllDowns() * 100 / actualNumberOfChicken, 1, 3)}"></td>
			</tr><tr class="border_cycle table_cycle_strong color_trzeci_wiersz gray_strong">
        <td class="border_cycle" align="center">Uwagi</td>
        <td class="border_cycle" align="center">Pasza</td>
        <td class="border_cycle" align="center">Lekarstwa</td>
		<td class="border_cycle" align="center">Edytuj</td>
	</tr><tr class="black_strong">
        <td class="border_cycle" align="center" th:text="${d.getComments()}"></td>
        <td class="border_cycle" align="center"><a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown zmniejszenie_buttonow_cycle" role="button" id="forageDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dostawa paszy</a>
			<form class="dropdown-menu p-2" autocomplete="off" th:action="@{'/home/cycle/day/forage/' + ${d.getId()}}" th:object="${forageDto}" th:method="put">
            <div class="form-group"><label>Rodzaj paszy<input type="text" th:field="*{name}" class="form-control" id="forageName"></label></div>
            <div class="form-group"><label>Ilość<input type="number" th:field="*{quantity}" class="form-control" id="quantity"></label></div>
            <div class="form-group"><label>Cena<input type="number" th:field="*{price}" class="form-control" id="foragePrice"></label></div>
			<button type="submit" class="btn btn-primary newDropdown_house">Dodaj dostawę</button>
        	</form></td>
		<td class="border_cycle" align="center"><a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown zmniejszenie_buttonow_cycle" role="button" id="medicineDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Lekarstwa</a>
            <form class="dropdown-menu p-2" autocomplete="off" th:action="@{'/home/cycle/day/medicine/' + ${d.getId()}}" th:object="${medicineDto}" th:method="put">
            <div class="form-group"><label>Nazwa lekarstwa<input type="text" th:field="*{name}" class="form-control" id="name"></label></div>
            <div class="form-group"><label>Cena<input type="number" th:field="*{price}" class="form-control" id="medicinePrice"></label></div>
			<button type="submit" class="btn btn-primary newDropdown_house">Dodaj lekarstwo</button>
        	</form></td>
		<td class="border_cycle" align="center"><a class="btn btn-secondary dropdown-toggle col-md-12 editHouseDropdown zmniejszenie_buttonow_cycle" role="button" id="dayDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Edycja dnia</a>
            <form class="dropdown-menu p-2" autocomplete="off" th:action="@{'/home/cycle/day/' + ${d.getId()}}" th:method="put" th:object="${d}"><input type="hidden" th:value="*{id}" name="id"/>
            <div class="form-group"><label>Upadki<input type="number" th:value="*{naturalDowns}" name="naturalDowns" class="form-control" id="editNaturalDowns"></label></div>
            <div class="form-group"><label>Selekcja<input type="number" th:value="*{selectionDowns}" name="selectionDowns" class="form-control" id="editSelectionDowns"></label></div>
            <div class="form-group"><label>Stan licznika wody<input type="number" th:value="*{waterCounter}" name="waterCounter" class="form-control" id="editWaterCounter"></label></div>
            <div class="form-group"><label>Średnia waga kurczaka<input type="number" th:value="*{averageWeight}" name="averageWeight" class="form-control" id="editAverageWeight"></label></div>
            <div class="form-group"><label>Uwagi<input type="text" th:value="*{comments}" name="comments" class="form-control" id="editComments"></label></div>
			<button type="submit" class="btn btn-primary newDropdown_house">Edytuj</button>
            </form></td>
		</tr></table></div></div></div></div></div>
    </div>
</body>
</html>